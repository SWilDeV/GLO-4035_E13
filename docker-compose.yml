version: "3.9"
services:
  app:
    build: .
    depends_on:
      - neo4j
    command: python3 -u populate.py

  web:
    build: .
    ports:
      - "8080:8080"

  neo4j:
    container_name: neo4j_backend
    image: neo4j:3.5.8
    hostname: localhost
    expose:
      - 7474
      - 7687

    ports:
      - "7474:7474"
      - "7687:7687"

    environment:
      - NEO4J_AUTH=$NEO4J_CREDENTIALS
      - NEO4J_INTERNAL_URL=$NEO4J_INTERNAL_URL

  mongodb:
    image: mongo:5.0
    ports:
      - 27017:27017
    volumes:
      - ~/apps/mongo:/data/db
    environment:
      - MONGO_INITDB_ROOT_USERNAME=root
      - MONGO_INITDB_ROOT_PASSWORD=S3cret
